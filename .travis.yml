language: node_js
node_js:
  - 4.4.4

env:
  global:
  - secure: "kyFasxxGgDNI+bQgqDXWR/hSvpG8oTCUxK47gYUs8kfmiYAvdySvmd7lbpn2zIjzWTTUjw1CAWQNswYnB3lo65GuTcSQf9y6Fde9gLL1snU+fOE60dSxyrfFHwEQY4Yg9PXnOgY8IcepZZV9btQboB+0fkzuz/tZX5NSKEh1DOJ1LZwjJv0K37yTVRj7JWsX1kaDkBLFPpVT0X3JY+QwqZUMYkZGRYYUEqcHiEtkpdFdu4pOXlE22UnTctSIit7OFO3o+4MG6R89duFgvPXi+M6FCF+cjvCYhL6bemAFcgGO2kbAnULTY+4YPnVARNAQTNwy17uEPmUPmA97VAkmrjCYREQfj0FRiARwzjQYeR7coUvBcsVWzBTXh4WShbr2uYZeJbmra9V1ZelxA3JwpTRe6OXI+Na9p7U92hK7TTb2robokdl1r1VRdJIGFyqTM+VfwDUNkdzXNTgke9hCMpGJxMKbbTRA3Gt9rKeRn1mlYJ7p+wKMdjSDs+mEejW7irP3w4edUKR/7iuQONIQgh3IJMrdlRONeZpACXEz2nVwa/VFfymeNdYOHhL2toSOCcqDG1bEoTMy4abWjm8KDh+CRv0eGMFyyuPNh+B2u90mWjbXTb5BilRh1eKJf9DyJFf9JgIbOkXW9vH71MMmppo9mbBperKb7qR2p3p9ego="

install:
- npm install -g harp@0.20.3

script:
- pushd _src && harp compile --output ../_site && popd

after_success: >
  echo $TRAVIS_BRANCH; echo $TRAVIS_PULL_REQUEST;
  if [[ $TRAVIS_BRANCH == 'master' && $TRAVIS_PULL_REQUEST == 'false' ]]; then
    # Configure Git with Travis CI information
    git config --global user.email "travis@travis-ci.org" ;
    git config --global user.name "travis-ci" ;
    # Delete the current repository
    rm -rf .git ;
    # Rebuild the repository from the generated files and push to GitHub pages
    cd _site ;
    git init ;
    git add . ;
    git commit -m "Deploy Travis CI build $TRAVIS_BUILD_NUMBER to GitHub pages" ;
    git push -f https://${GH_TOKEN}@github.com/${TRAVIS_REPO_SLUG} master:gh-pages ;
  fi
